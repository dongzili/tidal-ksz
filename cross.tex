Due to the cancellation of positive and negative velocity, direct cross correlation between kSZ signal and density field is hard to see.
Therefore, we first estimate the peculiar velocity from the 3D density field, 
then construct the 2D map of kSZ signal, 
and correlate it with the real kSZ signal \cite{Shao11}.

Detailed steps are as follows.

(1) Estimate the velocity field:

In linear region, the continuity equation goes like:
$\dot \delta+\nabla \cdot \bm{v}=0$, 
where $\bm{v}$ is the peculiar velocity and $\delta$ is the matter overdensity. 

Therefore, we obtain an estimator of velocity distribution:
\begin{eqnarray}
	\label{eq:v}
\hat v_z(\bm{k})=i a H f\delta(\bm{k})\frac{k_z}{k^2}\,
\end{eqnarray}
where $f=\frac{d\mathrm{ln}D}{d\mathrm{ln}a}$, D(a) is the linear growth function, 
a is the scale factor, H is the Hubble parameter.

$v_z \propto \frac{k_z}{k^2}$, indicating the most prominent signal comes from small k mode, which corresponds to large scale structure. 
This further verify our motivation for tidal reconstruction procedure.

(2) suppress the noise in velocity field with a new Wiener filter, following identical procedure as Eq.(\ref{eq:wiener}). This is because the term $\frac{k_z}{k^2}$ in Eq.(\ref{eq:v}) will strongly amplify noises in small k modes. 

(3) Calculate 2D kSZ map.

The CMB temperature fluctuations caused by kSZ effect is:
\begin{eqnarray}
\label{eq:ksz}
\Theta_{kSZ}(\hat n)\equiv\frac{\Delta T_{kSZ}}{T_{\mr{CMB}}}
=-\frac{1}{c}\int d\eta  g(\eta)  \bm{p}_\parallel\ ,
\end{eqnarray}
where $\eta(z)$ is the comoving distance at redshift z, $g(\eta)=e^{-\tau} d\tau/d\eta$ is the visibility function, $\tau$ is the optical depth to Thomson scattering, $\bm{p}_\parallel=(1+\delta)\bm{v}_\parallel$, with $\delta$ the electron overdensity. 
We assume that $g(\eta)$ doesn't change significally in one redshift bin, 
and integrate $\bm{p}_\parallel$ along radial axis to get $\hat \Theta_{kSZ}$

(4) Calculate correlation coefficients.

We compare reconstructed kSZ signals $\hat \Theta_{kSZ}$ with kSZ signals $\Theta_{kSZ}$ directly from simulations. 
To quantify the tightness of correlation, we employ a quantity r: 
\begin{eqnarray}
	r\equiv \frac{P_{recon,real}}{\sqrt{P_{recon}P_{real}}}\,
\end{eqnarray}


